---
import Layout from "@/layouts/Layout.astro";
import { URL_BASE } from "@/variables";
import Form from "@/sections/Form.astro";
import BackIcon from "@/icons/BackIcon.astro";
---

<Layout>
  <main
    id="main-container"
    class="min-h-screen flex flex-col overflow-clip transition-all duration-500 bg-ochre-influvac"
    style={`background-image: url('${URL_BASE}/img/bg/banner2.webp'); background-size: cover; background-position: center;`}
  >
    <header class="p-4 md:p-8">
      <div class="max-w-7xl mx-auto">
        <a href={URL_BASE}>
          <img
            id="dynamic-logo"
            class="w-52 h-auto"
            src={`${URL_BASE}/img/logoabbott_white.webp`}
            alt="Logo de Abbott"
            data-white-logo={`${URL_BASE}/img/logoabbott_white.webp`}
            data-color-logo={`${URL_BASE}/img/logoabbott_color.webp`}
          />
        </a>
      </div>
    </header>

    <!-- Contenedor de vistas -->
    <section class="w-6xl max-w-full mx-auto p-4 pb-10 flex-1">
      <!-- Vista 1: Formulario de Parámetros + Navegación -->
      <div id="view1" class="view-content active w-full flex items-center">
        <div class="flex gap-8 w-full">
          <!-- Formulario -->
          <div class="max-w-2xl">
            <Form />
          </div>

          <!-- Botones de navegación -->
          <div class="flex-1 flex items-center justify-center">
            <div class="flex flex-col gap-8">
              <button
                class="bg-blue-influvac font-bold text-3xl py-6 px-8 rounded-full text-white view-nav-btn transition-all duration-300 hover:bg-blue-influvac/90 hover:scale-105 shadow-lg cursor-pointer"
                data-view="view2"
                data-bg="banner3"
              >
                IMPACTO <br /> PRESUPUESTAL
              </button>
              <button
                class="bg-blue-influvac font-bold text-3xl py-6 px-8 rounded-full text-white view-nav-btn transition-all duration-300 hover:bg-blue-influvac/90 hover:scale-105 shadow-lg cursor-pointer"
                data-view="view3"
                data-bg="banner5"
              >
                COSTO - BENEFICIO <br /> COSTO - EFECTIVIDAD
              </button>
              <button
                class="bg-blue-influvac font-bold text-3xl py-6 px-8 rounded-full text-white view-nav-btn transition-all duration-300 hover:bg-blue-influvac/90 hover:scale-105 shadow-lg cursor-pointer"
                data-view="view4"
                data-bg="banner6"
              >
                CASOS <br /> DE INFLUENZA
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Vista 2: Impacto Presupuestal -->
      <div id="view2" class="view-content hidden w-full">
        <!-- Main Content Container -->
        <div class="max-w-3xl">
          <!-- Comparison Table -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-6">
            <!-- Table Header -->
            <div
              class="grid grid-cols-3 bg-ochre-influvac text-white font-bold"
            >
              <div class="p-3"></div>
              <div class="p-3 text-center border-r border-ochre-influvac">
                NO VACUNAR
              </div>
              <div class="p-3 text-center">VACUNACIÓN TETRAVALENTE</div>
            </div>

            <!-- Table Rows -->
            <div class="divide-y divide-gray-200">
              <!-- Row 1 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Población Vacunada
                </div>
                <div class="p-3 text-center border-r border-gray-200">0</div>
                <div class="p-3 text-center">2000</div>
              </div>

              <!-- Row 2 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Porcentaje de vacunación
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  0,00%
                </div>
                <div class="p-3 text-center">40,00%</div>
              </div>

              <!-- Row 3 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Costo de la vacunación
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 0,00
                </div>
                <div class="p-3 text-center">$ 110.000.000</div>
              </div>

              <!-- Row 4 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Empleados con incapacidad médica
                </div>
                <div class="p-3 text-center border-r border-gray-200">408</div>
                <div class="p-3 text-center">140</div>
              </div>

              <!-- Row 5 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Días de incapacidad médica
                </div>
                <div class="p-3 text-center border-r border-gray-200">2040</div>
                <div class="p-3 text-center">700</div>
              </div>

              <!-- Row 6 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Salarios pagados en ausentismo
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 163.200.000
                </div>
                <div class="p-3 text-center">$ 56.000.000</div>
              </div>

              <!-- Row 7 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Pérdida de productividad
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 4.973.944.420
                </div>
                <div class="p-3 text-center">$ 1.706.745.634</div>
              </div>

              <!-- Row 8 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Gastos de vacunación
                </div>
                <div class="p-3 text-center border-r border-gray-200">$ 0</div>
                <div class="p-3 text-center">$ 110.000.000</div>
              </div>

              <!-- Row 9 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Pérdidas Operativas
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 5.137.144.420
                </div>
                <div class="p-3 text-center">$ 1.762.745.634</div>
              </div>

              <!-- Row 10 -->
              <div class="grid grid-cols-3 hover:bg-gray-50">
                <div
                  class="p-3 font-medium bg-ochre-influvac/20 border-r border-gray-200"
                >
                  Impacto presupuestal
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 5.137.144.420
                </div>
                <div class="p-3 text-center">$ 1.872.745.634</div>
              </div>

              <!-- Savings Row -->
              <div class="grid grid-cols-3 font-bold">
                <div
                  class="p-3 bg-ochre-influvac/20 border-r border-gray-200 text-center"
                >
                  Ahorro:
                </div>
                <div class="p-3 text-center border-r border-gray-200"></div>
                <div class="p-3 text-center text-green-600">
                  $ 3.264.398.785
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="w-full flex justify-between items-end">
          <div
            class="bg-brown-influvac bg-opacity-90 text-white p-6 rounded-lg shadow-lg max-w-3xl"
          >
            <p class="text-lg leading-relaxed">
              La inversión en vacunación para 2000 trabajadores es de
              $110.000.000, lo que cubre al 40,0% de los colaboradores. Este
              nivel de protección evita que 268 personas se enfermen y reduce en
              1340 el número de dias de incapacidad.
            </p>
          </div>
          <div>
            <button
              class="bg-brown-influvac text-white p-2 rounded-lg font-semibold hover:bg-brown-influvac/90 transition-colors view-nav-btn border border-white cursor-pointer"
              data-view="view1"
              data-bg="banner2"
            >
              <BackIcon />
            </button>
          </div>
        </div>
      </div>

      <!-- Vista 3: Costo-Beneficio / Costo-Efectividad -->
      <div id="view3" class="view-content hidden w-full">
        <div class="max-w-3xl">
          <!-- Primera tabla: Costos -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-4">
            <!-- Table Header -->
            <div class="grid grid-cols-3 bg-blue-influvac text-white font-bold">
              <div class="p-3"></div>
              <div class="p-3 text-center border-r border-white">
                NO VACUNAR
              </div>
              <div class="p-3 text-center">VACUNACIÓN TETRAVALENTE</div>
            </div>

            <!-- Table Rows -->
            <div class="divide-y divide-gray-200">
              <!-- Row 1: Costo de la vacunación -->
              <div class="grid grid-cols-3">
                <div
                  class="p-3 font-medium bg-blue-influvac/20 border-r border-gray-200"
                >
                  Costo de la vacunación
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 0,00
                </div>
                <div class="p-3 text-center">$ 110.000.000</div>
              </div>

              <!-- Row 2: Gasto Total -->
              <div class="grid grid-cols-3">
                <div
                  class="p-3 font-medium bg-blue-influvac/20 border-r border-gray-200"
                >
                  Gasto Total
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 5.137.144.420
                </div>
                <div class="p-3 text-center">$ 1.872.745.634</div>
              </div>

              <!-- Row especial: Relación costo-beneficio -->
              <div class="grid grid-cols-3 bg-blue-influvac/10">
                <div
                  class="col-span-2 p-3 font-bold text-center border-r border-gray-200 text-lg"
                >
                  Relación costo - beneficio
                </div>
                <div class="p-3 text-center font-bold text-lg">30,68</div>
              </div>
            </div>
          </div>

          <div class="bg-white p-6 rounded-lg shadow-lg mb-6">
            <p class="text-lg leading-relaxed text-gray-800">
              <span
                >Por cada <strong>$1</strong> invertido en la vacunación, se ahorran
                <strong>$30,68</strong></span
              > para la empresa.
            </p>
          </div>

          <!-- Segunda tabla: Resultados clínicos -->
          <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-6">
            <!-- Table Header -->
            <div class="grid grid-cols-3 bg-blue-influvac text-white font-bold">
              <div class="p-3"></div>
              <div class="p-3 text-center border-r border-white">
                NO VACUNAR
              </div>
              <div class="p-3 text-center">VACUNACIÓN TETRAVALENTE</div>
            </div>

            <!-- Table Rows -->
            <div class="divide-y divide-gray-200">
              <!-- Row 1: Gasto Total -->
              <div class="grid grid-cols-3">
                <div
                  class="p-3 font-medium bg-blue-influvac/20 border-r border-gray-200"
                >
                  Gasto Total
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  $ 5.137.144.419,73
                </div>
                <div class="p-3 text-center">$ 1.872.745.634,22</div>
              </div>

              <!-- Row 2: Días de incapacidad -->
              <div class="grid grid-cols-3">
                <div
                  class="p-3 font-medium bg-blue-influvac/20 border-r border-gray-200"
                >
                  Días de incapacidad
                </div>
                <div class="p-3 text-center border-r border-gray-200">
                  2.040,00
                </div>
                <div class="p-3 text-center">700,00</div>
              </div>

              <!-- Row especial: ICER -->
              <div class="grid grid-cols-3 bg-blue-influvac/10">
                <div
                  class="col-span-2 p-3 font-bold text-center border-r border-gray-200 text-lg"
                >
                  Relación costo-eficacia incremental (ICER)
                </div>
                <div class="p-3 text-center font-bold text-lg">
                  $ 2.436.118,50
                </div>
              </div>
            </div>
          </div>

          <div class="bg-white p-6 rounded-lg shadow-lg">
            <p class="text-lg leading-relaxed text-gray-800">
              <span
                >Por cada día de incapacidad evitado por la vacunación, se
                obtiene un ahorro de <strong>$2.436.118</strong></span
              >
            </p>
          </div>
        </div>
        <div class="w-full flex justify-end">
          <div>
            <button
              class="bg-brown-influvac text-white p-2 rounded-lg font-semibold hover:bg-brown-influvac/90 transition-colors view-nav-btn border border-white cursor-pointer"
              data-view="view1"
              data-bg="banner2"
            >
              <BackIcon />
            </button>
          </div>
        </div>
      </div>

      <!-- Vista 4: Casos de Influenza -->
      <div id="view4" class="view-content hidden w-full">
        <div class="flex gap-8 items-end">
          <div class="flex-1 flex flex-col gap-6">
            <!-- Primer título y gráfica -->
            <div class="bg-white rounded-lg shadow-lg p-6 flex-1">
              <h3
                class="text-2xl font-bold text-ochre-influvac mb-4 text-center"
              >
                NO VACUNAR
              </h3>
              <div class="h-full">
                <canvas id="chart-no-vacunar" class="w-full h-full max-h-64"
                ></canvas>
              </div>
            </div>

            <!-- Segundo título y gráfica -->
            <div class="bg-white rounded-lg shadow-lg p-6 flex-1">
              <h3
                class="text-2xl font-bold text-ochre-influvac mb-4 text-center"
              >
                VACUNACIÓN TETRAVALENTE
              </h3>
              <div class="h-full">
                <canvas
                  id="chart-vacunacion-tetravalente"
                  class="w-full h-full max-h-64"></canvas>
              </div>
            </div>
          </div>
          <div>
            <button
              class="bg-ochre-influvac text-white p-2 rounded-lg font-semibold hover:bg-ochre-influvac/90 transition-colors view-nav-btn border border-white cursor-pointer"
              data-view="view1"
              data-bg="banner2"
            >
              <BackIcon />
            </button>
          </div>
        </div>

        <!-- Botón de regreso -->
      </div>
    </section>
  </main>
</Layout>

<script is:inline src="/apps/abbott/costoefectividad-influvac/js/chart.js"
></script>

<script>
  import { ViewManagerRefactored } from "@/utils";

  document.addEventListener("DOMContentLoaded", () => {
    new ViewManagerRefactored();
  });
</script>

<style>
  .view-content {
    transition: opacity 0.3s ease-in-out;
  }

  .view-content.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .view-content.active {
    opacity: 1;
    pointer-events: auto;
  }

  .view-nav-btn {
    transition: all 0.3s ease;
  }
</style>
